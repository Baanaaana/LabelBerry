<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Labelberry Admin Dashboard</title>
    <link rel="stylesheet" href="/static/css/dashboard.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="ri-printer-line"></i> Labelberry Admin Dashboard</h1>
            <div class="header-stats">
                <div class="stat">
                    <span class="stat-value" id="total-pis">0</span>
                    <span class="stat-label">Total Printers</span>
                </div>
                <div class="stat">
                    <span class="stat-value" id="online-pis">0</span>
                    <span class="stat-label">Online</span>
                </div>
                <div class="stat">
                    <span class="stat-value" id="jobs-today">0</span>
                    <span class="stat-label">Jobs Today</span>
                </div>
            </div>
        </header>

        <div class="actions-bar">
            <button class="btn btn-primary" onclick="showRegisterModal()">
                <i class="ri-add-line"></i> Register New Pi
            </button>
            <button class="btn btn-secondary" onclick="refreshDashboard()">
                <i class="ri-refresh-line"></i> Refresh
            </button>
            <button class="btn btn-secondary" onclick="showSettingsModal()">
                <i class="ri-settings-3-line"></i> Settings
            </button>
        </div>

        <div class="printers-grid" id="printers-grid">
            <!-- Printer cards will be dynamically added here -->
        </div>
    </div>

    <!-- Register Pi Modal -->
    <div id="register-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeRegisterModal()">&times;</span>
            <h2>Register New Raspberry Pi</h2>
            <form id="register-form" onsubmit="registerPi(event)">
                <div class="form-group">
                    <label for="device-id">Device ID:</label>
                    <input type="text" id="device-id" required placeholder="Enter Device ID from Pi">
                </div>
                <div class="form-group">
                    <label for="api-key">API Key:</label>
                    <input type="text" id="api-key" required placeholder="Enter API Key from Pi">
                </div>
                <div class="form-group">
                    <label for="friendly-name">Friendly Name:</label>
                    <input type="text" id="friendly-name" required placeholder="e.g., Warehouse Printer 1">
                </div>
                <div class="form-group">
                    <label for="location">Location (optional):</label>
                    <input type="text" id="location" placeholder="e.g., Building A, Floor 2">
                </div>
                <div class="form-group">
                    <label for="printer-model">Printer Model (optional):</label>
                    <input type="text" id="printer-model" placeholder="e.g., Zebra ZD220">
                </div>
                <button type="submit" class="btn btn-primary">Register Pi</button>
            </form>
        </div>
    </div>

    <!-- Test Print Modal -->
    <div id="print-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closePrintModal()">&times;</span>
            <h2>Send Test Print to <span id="print-pi-name"></span></h2>
            <form id="print-form" onsubmit="sendPrint(event)">
                <div class="form-group">
                    <label>Print Method:</label>
                    <div class="radio-group">
                        <label>
                            <input type="radio" name="print-method" value="raw" checked onchange="togglePrintMethod()">
                            Raw ZPL Code
                        </label>
                        <label>
                            <input type="radio" name="print-method" value="file" onchange="togglePrintMethod()">
                            ZPL File
                        </label>
                        <label>
                            <input type="radio" name="print-method" value="url" onchange="togglePrintMethod()">
                            ZPL URL
                        </label>
                    </div>
                </div>
                
                <div id="raw-input" class="form-group">
                    <label for="zpl-raw">ZPL Code:</label>
                    <textarea id="zpl-raw" rows="10" placeholder="^XA&#10;^FO50,50^A0N,50,50^FDTest Label^FS&#10;^XZ">^XA
^FO50,50^A0N,50,50^FDLabelberry Test^FS
^FO50,120^A0N,30,30^FDAdmin Dashboard Print^FS
^FO50,170^A0N,25,25^FDTime: ${new Date().toLocaleString()}^FS
^XZ</textarea>
                </div>
                
                <div id="file-input" class="form-group" style="display:none;">
                    <label for="zpl-file">Select ZPL File:</label>
                    <input type="file" id="zpl-file" accept=".zpl,.txt">
                </div>
                
                <div id="url-input" class="form-group" style="display:none;">
                    <label for="zpl-url">ZPL URL:</label>
                    <input type="url" id="zpl-url" placeholder="https://example.com/label.zpl">
                </div>
                
                <button type="submit" class="btn btn-primary">Send Print Job</button>
            </form>
        </div>
    </div>

    <!-- Pi Details Modal -->
    <div id="details-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeDetailsModal()">&times;</span>
            <h2>Printer Details: <span id="details-pi-name"></span></h2>
            <div id="pi-details-content">
                <!-- Details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Edit Pi Modal -->
    <div id="edit-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEditModal()">&times;</span>
            <h2>Edit Printer: <span id="edit-pi-name"></span></h2>
            <form id="edit-form" onsubmit="updatePi(event)">
                <input type="hidden" id="edit-pi-id">
                <div class="form-group">
                    <label for="edit-friendly-name">Friendly Name:</label>
                    <input type="text" id="edit-friendly-name" required>
                </div>
                <div class="form-group">
                    <label for="edit-location">Location:</label>
                    <input type="text" id="edit-location" placeholder="e.g., Building A, Floor 2">
                </div>
                <div class="form-group">
                    <label for="edit-printer-model">Printer Model:</label>
                    <input type="text" id="edit-printer-model" placeholder="e.g., Zebra ZD220">
                </div>
                <button type="submit" class="btn btn-primary">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeDeleteModal()">&times;</span>
            <h2>Delete Printer</h2>
            <p>Are you sure you want to delete <strong id="delete-pi-name"></strong>?</p>
            <p class="warning-text">This action cannot be undone. The printer will need to be re-registered to use it again.</p>
            <input type="hidden" id="delete-pi-id">
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeDeleteModal()">Cancel</button>
                <button class="btn btn-danger" onclick="confirmDelete()">Delete Printer</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeSettingsModal()">&times;</span>
            <h2><i class="ri-settings-3-line"></i> Dashboard Settings</h2>
            <form id="settings-form" onsubmit="saveSettings(event)">
                <div class="form-group">
                    <label for="timezone-select">Timezone:</label>
                    <select id="timezone-select" class="form-control">
                        <optgroup label="Europe">
                            <option value="Europe/Amsterdam">Amsterdam (CET/CEST)</option>
                            <option value="Europe/London">London (GMT/BST)</option>
                            <option value="Europe/Paris">Paris (CET/CEST)</option>
                            <option value="Europe/Berlin">Berlin (CET/CEST)</option>
                            <option value="Europe/Brussels">Brussels (CET/CEST)</option>
                            <option value="Europe/Madrid">Madrid (CET/CEST)</option>
                            <option value="Europe/Rome">Rome (CET/CEST)</option>
                            <option value="Europe/Stockholm">Stockholm (CET/CEST)</option>
                            <option value="Europe/Moscow">Moscow (MSK)</option>
                        </optgroup>
                        <optgroup label="Americas">
                            <option value="America/New_York">New York (EST/EDT)</option>
                            <option value="America/Chicago">Chicago (CST/CDT)</option>
                            <option value="America/Denver">Denver (MST/MDT)</option>
                            <option value="America/Los_Angeles">Los Angeles (PST/PDT)</option>
                            <option value="America/Toronto">Toronto (EST/EDT)</option>
                            <option value="America/Mexico_City">Mexico City (CST)</option>
                            <option value="America/Sao_Paulo">São Paulo (BRT)</option>
                        </optgroup>
                        <optgroup label="Asia Pacific">
                            <option value="Asia/Tokyo">Tokyo (JST)</option>
                            <option value="Asia/Shanghai">Shanghai (CST)</option>
                            <option value="Asia/Hong_Kong">Hong Kong (HKT)</option>
                            <option value="Asia/Singapore">Singapore (SGT)</option>
                            <option value="Asia/Seoul">Seoul (KST)</option>
                            <option value="Asia/Kolkata">Mumbai (IST)</option>
                            <option value="Asia/Dubai">Dubai (GST)</option>
                            <option value="Australia/Sydney">Sydney (AEDT/AEST)</option>
                            <option value="Australia/Melbourne">Melbourne (AEDT/AEST)</option>
                            <option value="Pacific/Auckland">Auckland (NZDT/NZST)</option>
                        </optgroup>
                        <optgroup label="Other">
                            <option value="UTC">UTC</option>
                            <option value="GMT">GMT</option>
                        </optgroup>
                    </select>
                    <small class="form-text">Select your local timezone for displaying timestamps</small>
                </div>
                
                <div class="form-group">
                    <label for="refresh-interval">Auto-refresh interval:</label>
                    <select id="refresh-interval" class="form-control">
                        <option value="5000">5 seconds</option>
                        <option value="10000" selected>10 seconds</option>
                        <option value="30000">30 seconds</option>
                        <option value="60000">1 minute</option>
                        <option value="0">Disabled</option>
                    </select>
                    <small class="form-text">How often to refresh the dashboard data</small>
                </div>
                
                <div class="form-group">
                    <label for="date-format">Date format:</label>
                    <select id="date-format" class="form-control">
                        <option value="DD-MM-YYYY">DD-MM-YYYY (European)</option>
                        <option value="MM/DD/YYYY">MM/DD/YYYY (US)</option>
                        <option value="YYYY-MM-DD">YYYY-MM-DD (ISO)</option>
                    </select>
                    <small class="form-text">Format for displaying dates</small>
                </div>
                
                <button type="submit" class="btn btn-primary">Save Settings</button>
            </form>
        </div>
    </div>

    <script src="/static/js/dashboard.js"></script>
</body>
</html>